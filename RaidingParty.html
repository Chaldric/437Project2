<!--Raiding Party Main-->
<!DOCTYPE HTML>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <title>SimpleGame.html</title>
    <script type="text/javascript"
            src = "GE/simpleGame.js"></script>
    <script type="text/javascript">

    var scene;
    var groundImage;
    var groundImage2;
    var pDragon;
    var ground;
    var timer;

    function Dragon(){
      tempDragon = new Sprite(scene, "Images/standv2.png", 32, 44);
      tempDragon.falling = true;
      tempDragon.maxHorizontalSpeed = 5;
      tempDragon.jumpHeight = 10;
      tempDragon.jumpDoubleHeight = 10;
      tempDragon.mainJump = 0;
      tempDragon.secondaryJump = 0;
      tempDragon.maxNumJumps = 2;
      tempDragon.jumpKeyPressed = false;
      tempDragon.setAngle(90);
      tempDragon.setSpeed(0);

      tempDragon.checkKeys = function(){
        if (keysDown[K_LEFT] || keysDown[K_RIGHT]){
          if (keysDown[K_RIGHT]){
            //this.setSpeed(this.maxHorizontalSpeed);
            this.setDX(this.maxHorizontalSpeed);
          }
          if (keysDown[K_LEFT]){
            //this.setSpeed(-this.maxHorizontalSpeed);
            this.setDX(-this.maxHorizontalSpeed);
          }
        } else {
          //this.setSpeed(0);
          this.setDX(0);
        }

        if (keysDown[K_UP]){
            if (this.mainJump == 0){
              this.setDY(0);
              this.addVector(0, this.jumpHeight);
              this.mainJump = 1;
              this.jumpKeyPressed = true;
              //this.falling == true
            } else if (this.secondaryJump < tempDragon.maxNumJumps){
              if (!this.jumpKeyPressed){
                this.setDY(0);
                this.addVector(0, this.jumpDoubleHeight);
                this.secondaryJump += 1;
                this.jumpKeyPressed = true;
              }
            }
        } else {
          this.jumpKeyPressed = false;
          checkIfFalling();
        }
      } //end checkKeys

      tempDragon.checkIfLanded = function(){
        if (!this.falling){
          this.mainJump = 0;
          this.secondaryJump = 0;
        }
      } //end checkJumps

      tempDragon.checkGravity = function(){
        if (this.falling){
          if (this.dy < this.jumpHeight)
            this.addVector(180, 1);
          } else {
            this.setDY(0);
          }
          dragonBot = this.y + (this.height / 2);
          if (dragonBot >= ground){
            this.setPosition(this.x, ground- (this.height / 2));
            this.falling = false;
            //this.setDY(0);
          }

      } //end checkGravity

      return tempDragon;
    } //end Dragon class

    function checkIfFalling(){
      pDragon.falling = true;
      pDragonBotton = pDragon.y + (pDragon.height / 2);
      if(pDragon.collidesWith(groundImage)){
      //if(pDragonBotton >= ground-1){
        pDragon.falling = false;
        //pDragon.setDY(0);
        //alert("Hello! I am an alert box!!");
      }
    } //end checkIfFalling

    function init(){
      timer = new Timer();
      scene = new Scene();
      groundImage = new Sprite(scene, "Images/RedBox.png", 800, 100);
      groundImage.setPosition(400, 400);
      groundImage.setSpeed(0);
      groundImage2 = new Sprite(scene, "Images/RedBox.png", 100, 10);
      groundImage2.setPosition(0, 0);
      groundImage2.setSpeed(0);

      pDragon = new Dragon();
      ground = 500;

      scene.start();
      scene.setBG('black');
    } //end init

    function update(){
      scene.clear();
      groundImage.update();
      groundImage2.update();
      pDragon.update();

      pDragon.checkKeys();
      pDragon.checkGravity();
      pDragon.checkIfLanded();
      //pDragon.update();
      updateScore();
    } //end update

    function updateScore(){
    //update the scoreboard
      //scoreBoard.innerHTML = "PosX: " + pDragon.x + ". PosY: " + pDragon.y + ". VelX: " + pDragon.dx + ". VelY: " + pDragon.dy;
      scoreBoard.innerHTML = "PosY: " + pDragon.y + ". VelY: " + pDragon.dy + ". PosX: " + pDragon.x+ ". Width: " + pDragon.width + ". Height: " + pDragon.height;
      platFormPos.innerHTML = "PlatY: " + groundImage.y + ". PlatX: " + groundImage.x + ". PlatWidth: " + groundImage.width + ". PlatHeight: " + groundImage.height + ". PlatTop: " + (groundImage.y - (groundImage.height / 2));
    } // end updateScore

    </script>
  </head>
  <body onload = "init()">
    <div id = "scoreBoard"></div>
    <div id = "platFormPos"></div>


  </body>
</html>
